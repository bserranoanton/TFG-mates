\chapter{Introducción}
\label{cap:introduccion}

%\chapterquote{Frase célebre dicha por alguien inteligente}{Autor}

El año 2018 fue proclamado el Año Internacional de la Biología Matemática por dos sociedades científicas: la \textit{European Mathematical Society} (EMS) y la \textit{European Society for Mathematical and Theoretical Biology} (ESMTB). Con esta celebración se pretende señalar el incremento e importancia de las aplicaciones de las matemáticas a la biología y a las ciencias de la vida y fomentar esta interacción\footnote{\url{https://www.icmat.es/divulgacion/Material_Divulgacion/miradas_matematicas/06.pdf}}. En la actualidad, las ciencias de la vida tienen cada vez más aportaciones matemáticas, que van desde el uso de los sistemas dinámicos y la estadística, a los modelos de población y de propagación de enfermedades. En este contexto, los modelos cobran un papel relevante, puesto que son representaciones simplificadas de la estructura y del funcionamiento de un determinado sistema o proceso biológico, utilizando el lenguaje matemático para expresar las relaciones entre variables\footnote{\url{http://www.blogsanidadanimal.com/2018-el-ano-internacional-de-la-biologia-matematica/}}. Lo que permite avanzar más allá de donde la intuición puede llevarnos y pudiendo obtener información útil que, de otra manera es imposible, ya bien sea por el elevado coste económico de los experimentos, por el tiempo que lleva realizarlos, o por la cantidad de datos a examinar, entre otras razones. Pero no solo los expertos se benefician del poder de simplificación de los modelos matemáticos. Debido a la crisis sanitaria del COVID-19, han sido muchos los modelos utilizados no solo para predecir la propagación del virus sino también para concienciar a la sociedad del riesgo de esta, poniendo a disposición del público general conocimiento científico\footnote{Modelos matemáticos sobre la curva de crecimiento del COVID-19 en \textit{The Washington Post}: \url{https://www.washingtonpost.com/graphics/2020/world/corona-simulator/}}. 


A lo largo de este documento nos centraremos en el campo de la inmunología. El sistema inmune es un sistema complejo. A diferencia de otros sistemas, las células que lo componen no están reguladas por un órgano, al menos aún no se ha encontrado \citep{arias2016emergent}. Las células inmunes se mueven libremente por el organismo y llevan una vida independiente. Sin embargo, son capaces de llevar a cabo comportamientos colectivos, como es el caso de la respuesta ante agentes infecciosos. En esta función defensiva, las células T toman un papel importante, pues son las encargadas de coordinar la respuesta y de eliminar las células del organismo que han sido infectadas. Cuando se detecta una infección, la población de este tipo de células crece en pocos días y, una vez desaparecido el agente infeccioso, los niveles de población vuelven a restaurarse (en caso contrario se acumularían millones de células que no son necesarias para el organismo) \citep{fernandez2012mecanica}. El mecanismo de decisión entre división o apoptosis que toman las células T durante la respuesta inmune aún se desconoce. En los capítulos que siguen expondremos dos modelos matemáticos, basados en ecuaciones diferenciales, que intentan dar una explicación a este fenómeno. El primero de ellos, que puede verse en el Capítulo \ref{cap:descripcionTrabajo}, aborda este asunto desde un punto de vista microscópico. Es decir, se propone un algoritmo para cada célula. Por su parte, las ecuaciones del segundo modelo, expuesto en el Capítulo \ref{cap:modeloMacroscopico}, proporcionan un algoritmo de decisión para toda la población de células T, basado en dos características principales de la población: la elasticidad y la inercia.

 %Este modelo se contrapone a la rigidez de algunos modelos anteriores, basados en una cantidad fija de divisiones celulares o en la competición de relojes estocásticos, basando la decisión en la concentración de ciertas moléculas inhibidoras (de la división o del suicidio celular) en el medio ámbito extracelular que rodea a la célula. 
 

 
Además, se realizan simulaciones numéricas de ambos modelos. Estas simulaciones representan distintas situaciones que pueden darse durante una infección, entre ellas hacemos distinción entre la situación de intolerancia al \textit{patógeno}, en cuyo caso las células inmunes consiguen controlar la infección y eliminar al agente infeccioso, o la situación de tolerancia al \textit{patógeno}, en la que es este último quien acaba tomando el control del organismo. También se analiza qué ocurre cuando tenemos poblaciones de células T con distintas afinidades al \textit{patógeno}. La relación entre las simulaciones de ambos modelos constituye un tema interesante, que se aborda en el último capítulo. Como veremos, ambos dan lugar a resultados compatibles. 

%Los datos recogidos experimentalmente exponen la complejidad del SI, su no linealidad, sus redundancias, etc. Todo esto sumado al avance de la tecnología y la explosión de información, eso que llamamos hoy \textit{big data}, hacen que las soluciones automáticas (computarizadas) sean la única manera de acercarse a determinados problemas biológicos y médicos. 
%
%No debemos olvidar que los modelos matemáticos no son una representación $100\%$ fiable del problema que modelizan, pues la misión que tienen estos modelos es ayudar a comprender el funcionamiento de un determinado proceso cuyo conocimiento aún está incompleto, reproducirlo y predecir qué consecuencias  tendrá. Es, por tanto, importante, remarcar que los modelos se construyen sobre hipótesis aún inestables y que es precisamente esto lo que les hace tan potentes: permiten incluir variaciones, nuevas hipótesis, compararse con otros modelos,... y gracias a ello lograr una visión más amplia del problema. Pudiendo obtener información útil que de otra manera hubiera sido imposible, ya bien sea por razones del elevado coste económico de los experimentos, por el tiempo que lleva realizarlos, o por la cantidad de datos a examinar, entre otras razones. Pero no pensemos que los modelos ``aciertan'', también nos ayudan a descartar vías de investigación que no se ajusten a lo observado. Y eso es, sin duda, avanzar en el problema. 
%
%En este trabajo propondremos un modelo matemático muy simple, basado en ecuaciones diferenciales, con el cual modelizaremos la dinámica de población de unas células del SI muy destacadas: las células T. Además, acompañaremos estos resultados con simulaciones de dicho modelo. 


%\section{Motivación}
%
%
%La habilidad de nuestro sistema inmune (SI) para protegernos de los patógenos es ciertamente apasionante. Las células inmunes deben saber cómo diferenciar a las células amigas de las enemigas, cómo y dónde actuar.
%
%Son diversas las amenazas a las que el SI tiene que enfrentarse y dar una respuesta eficiente y proporcional. Estas amenazas pueden ser de naturaleza biológica (agentes patógenos), físico-químicas (como contaminantes o radiaciones) o internas (por ejemplo, las células cancerosas).
%
%A lo largo de los años, muchas preguntas sobre el funcionamiento del SI han sido respondidas, pero aún quedan muchas otras por responder: ¿Quién regula la actuación del SI? ¿qué influye en la respuesta inmune?, ¿cuál es el \textit{software} que llevan las células inmunes?... PROBLEMAS SIN RESOLVER EN INMUNOLOGÍA EN GENERAL (BUSCAR)
%
%Si bien parece natural pensar que hay un órgano que actúa de director, ese
%órgano, si existe, aún no se ha encontrado. Incita, por tanto, a considerar, que las
%células inmunes basan su actuación en la información local que encuentran a su
%alrededor. Y sobre esta suposición construiremos un modelo que describa las
%dos actuaciones básicas, división y muerte celular, que desarrollan las células inmunes que vamos a estudiar: las células T.
%
%De este comportamiento aparentemente complejo destacaremos la simplicidad: las células T tienen un número muy limitado de opciones, y estas vienen determinadas por el ambiente en el que se mueven y la información que recogen de él.
%
%
%A pesar de que en este trabajo nos centraremos en una tarea muy particular del SI, como es la dinámica de población de las células T, no debemos olvidar que estas células no son las únicas que forman parte de él, hay muchos otras, y de diversos tipos, interactuando con ellas. Pongamos un ejemplo que ayude a entender la dimensión del asunto: supongamos que estamos viendo un partido de fútbol en la televisión y nos enfocan a un jugador que va corriendo a toda velocidad y luego para en seco. Esto no parece tener mucho sentido. Después, repiten la misma jugada con un campo de visión más amplio, donde podemos ver todo el terreno de juego. Ahora entendemos que el jugador ha parado porque el equipo contrario se hizo con el balón que él estaba esperando. 
%
%Para la realización de este estudio presentaremos un modelo matemático, basado en ecuaciones diferenciales, que describa la dinámica de las células T, así como simulaciones de este mismo modelo...(a ver qué se hace aquí).
%----------------------
%
%A pesar de la descentralización en sus tareas y del poco margen de maniobra, es asombroso que el resultado que nos ofrece el SI sea tan eficiente.

\section{Objetivos}

Este trabajo de fin de grado se centra en el estudio de la dinámica de población de las células T. Concretamente, en el estudio de dos modelos matemáticos que pretenden dar respuesta a los mecanismos que rigen este comportamiento aún desconocido por la comunidad de biólogos. Para abordar este proyecto se determinaron los siguientes objetivos:

 \begin{itemize}
 	
	\item Estudio básico del sistema inmune, enfocado a conocer el papel que juegan las células T durante una respuesta inmune.
	
	\item Estudio y comprensión de los modelos matemáticos que se detallan en este documento y de su importancia en el ámbito de la biología.
	
 	\item Implementación del código necesario para simular distintos comportamientos de las células T basados en estos modelos y análisis de dichos comportamientos. 
 	
 	\item Obtención de una primera aproximación para lograr establecer una correspondencia entre los parámetros de los dos modelos estudiados. 
 \end{itemize}


\section{Plan de trabajo}

Para la realización de este trabajo se establecieron distintos hitos a lo largo del curso académico. Los primeros meses estaban destinados a una revisión previa de los conceptos biológicos subyacentes. Los cuales engloban nociones básicas sobre el sistema inmune y un estudio más detallado del comportamiento de las células T. Esto constituye una parte fundamental del trabajo, pues los modelos no pueden ser comprendidos en su totalidad si no se miran desde el problema biológico al que intentan dar respuesta. Una vez se afianzara la base biológica se podía comenzar con el estudio de los modelos. El primero que se estudiaría sería el modelo microscópico expuesto en \cite{JTB}. Se estableció la realización de distintas simulaciones del modelo, que complementarían la teoría vista. El segundo modelo, el modelo macroscópico \citep{arias2015growth}, sería estudiado después, con el propósito de poder relacionarlo con el modelo anterior. 


Una vez ambos modelos estuvieran revisados y se hubieran realizado las simulaciones correspondientes se abrió la posibilidad de intentar establecer una correspondencia entre los parámetros de ambos modelos mediante la implementación de una red neuronal. Esto último pondría fin al contenido de este trabajo de fin de grado.


\section{Estructura del documento}

Este trabajo está dividido en cuatro partes bien diferenciadas pero con la misma finalidad, el estudio de las células T y su dinámica de población durante una infección aguda. 

\begin{enumerate}
	\item En el Capítulo \ref{cap:estadoDeLaCuestion} se cubre el contexto del documento. En concreto, en la Sección \ref{sec:cuestInmuno} se tratan unas nociones básicas sobre inmunología, que permiten al lector continuar por los capítulos siguientes sin ningún impedimento terminológico, en cuanto a cuestiones biológicas se refiere. Esta sección pretende dar una visión general y muy básica del sistema inmune. Comienza con los mecanismos más simples, referentes al \textit{sistema inmune innato} (Sección \ref{sub:sistInmInnato}), hasta las más complejas, referentes al \textit{sistema inmune adaptativo} (Sección \ref{sub:sistInmAdap}). Más en detalle se exponen los aspectos de la respuesta inmune que involucran a las células T, como son su activación y actuación o la memoria inmune (Sección \ref{Tcell}). 
	
	Por su parte, la Sección \ref{sec:coop} aborda el papel de los modelos matemáticos en el campo de la biología. Desde la evolución de la cooperación de estas dos ciencias hasta las características y tipos de los modelos. La Sección \ref{sub:modelosvsinmuno} se especializa en el área de la inmunología. Concretamente en la Sección \ref{cuestionAmodelizar}, nos centramos en el caso de nuestro estudio, los distintos modelos matemáticos formulados para la dinámica de las células T durante una infección aguda.
	 
	
	\item En el Capítulo \ref{cap:descripcionTrabajo} se expone el marco teórico del modelo microscópico propuesto para el problema de decisión entre división y apóptosis de las células T. En la Sección \ref{sec:hip_bio} se detallan las hipótesis biológicas sobre las que se sustenta el modelo, que constituyen hechos contrastados y observados en el campo de la biología. El modelo en sí puede verse en la Sección \ref{sec:modelo}, donde se detalla la notación que seguirá el resto del documento y las ecuaciones diferenciales de primer orden que dan lugar al algoritmo. La última sección de este capítulo, la Sección \ref{sec:modeloPatCelT}, introduce una ecuación diferencial para la dinámica de población del \textit{patógeno} y su relación con la cantidad de células T disponibles. La ecuación establece la interacción entre ambas poblaciones.
	
	En el Capítulo \ref{cap:simulaciones} se presentan las simulaciones correspondientes a una simplificación, en número de parámetros del modelo anterior (Sección \ref{sec:modelo_simplif}) y se explican los detalles básicos de la implementación del mismo (Sección \ref{sec:implem_pseudo}). Los resultados de las simulaciones se exponen en la Sección \ref{sec:simulacionesMicro}. Estas simulaciones corresponden a casos de intolerancia y tolerancia al \textit{patógeno} (Secciones \ref{sim:intoler} y \ref{sim:toler}, respectivamente), así como el caso de la respuesta inmune con poblaciones de células T con distintas afinidades al \textit{patógeno} (Sección \ref{sim:difPoblacionesT}).
	
	
	\item El modelo macroscópico se estudia en el Capítulo \ref{cap:modeloMacroscopico}. Las ecuaciones diferenciales de segundo grado de este modelo rigen la dinámica de población de las células T y el \textit{patógeno} de manera colectiva, a diferencia del modelo microscópico, cuyo algoritmo estaba definido para cada una de las células. Este modelo está basado en dos características del comportamiento de la población de células T durante una respuesta inmune: la elasticidad y la inercia (Sección \ref{sec:iner_elast}). También se expresan las ecuaciones del modelo en forma adimensional, consiguiendo así reducir el número de parámetros a la mitad.
	
	Además de proponerse el marco teórico, también se realizan las simulaciones numéricas correspondientes al modelo en la Seccion \ref{sec:simu_macro}. Estas recogen los casos de intolerancia y tolerancia al \textit{patógeno} (Secciones \ref{sub:simMacroIntoler} y \ref{sub:simMacroToler}, respectivamente) y, para el modelo macroscópico adimensional, se estudia la relevancia del valor de sus dos parámetros en las regiones de tolerancia e intolerancia (Sección \ref{sub:reg_tolerIntolerMacro}).
	
	\item Dados los modelos propuestos en los Capítulos \ref{cap:descripcionTrabajo} y \ref{cap:modeloMacroscopico}, y tras la comparación de sus resultados, se busca una correspondencia de parámetros entre ambos modelos en el Capítulo \ref{cap:redNeuronal}. Para ello se implementa una red neuronal capaz de realizar ``la función inversa'' al código referente a las simulaciones del modelo macroscópico. Es decir, dados los resultados de una simulación, predecir el valor de los parámetros necesarios para obtener ese mismo resultado. La construcción del conjunto de datos y la implementación de la red puede verse en la Sección \ref{sec:conjDatos_entreRed}. Los resultados obtenidos y un ejemplo de ejecución, usando como entrada los resultados de una simulación del modelo microscópico, pueden verse en la Sección \ref{sec:resultadoRed}.
	
\end{enumerate}

Por último, el Capítulo \ref{cap:conclusiones} ofrece una breve conclusión sobre el trabajo realizado. A fin de complementar el trabajo, se ha incluido el código principal de las simulaciones de los modelos (tanto las del Capítulo \ref{cap:simulaciones} como las del \ref{cap:modeloMacroscopico}) en el Apéndice \ref{Appendix:A}.






